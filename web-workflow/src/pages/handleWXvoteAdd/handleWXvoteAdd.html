<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <title><%=title%></title>

    <link rel="import" href="../../components/head/head.html?__inline">

    <link rel="stylesheet" href="handleWXvoteAdd.scss?__inline">
</head>
<body>

<div id="app">

    <link rel="import" href="../../components/header/header.html?__inline">
    <link rel="import" href="../../components/menu/menu.html?__inline">

    <div id="app-content" class="app-content am-g">

        <div id="wxFans" class="am-panel am-panel-primary">
            <div class="am-panel-hd"><%= title %></div>
            <div class="am-panel-bd">

                <div class="am-panel am-panel-danger">
                    <div class="am-panel-hd prompt-title">提示</div>
                    <div class="am-panel-bd">
                        1、同一任务请不要分开多次发布，造成投手重复提交量不足平台概不负责。<br/>
                        2、请准确清楚填写各项发布内容，以便投手高效迅速完成任务。<br/>
                        3、为保证平台良性发展，平台监督力度加强，无论是发布者或投手，一次违规，直接封号。望各位相互监督，共谋利益。<br/>
                    </div>
                </div>

                <validator name="wxFans">
                    <form class="am-form am-form-horizontal" enctype="multipart/form-data" method="post" action="/artificial/WX/vote/add" >
                        <input type="hidden" value="<%= orderFlag %>" name="orderFlag">
                        <div class="am-form-group">
                            <label for="title" class="am-u-sm-4 am-u-lg-2 am-form-label"><span class="tips">* </span>任务标题</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                                <input id="title" class="am-radius am-input-sm" type="text" placeholder="请填任务标题"
                                       v-validate:title="{required: true}" name="title">
                                <span class="tips" v-if="$wxFans.title.required">任务标题不能为空!</span>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="fansID" class="am-u-sm-4 am-u-lg-2 am-form-label"><span class="tips">* </span>投票地址</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                                <input id="fansID" class="am-radius am-input-sm" type="text" placeholder="请填写投票地址"
                                       v-validate:account="{required: true}" name="address">
                                <span class="tips" v-if="$wxFans.account.required">投票地址不能为空!</span>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="fansRemark" class="am-u-sm-4 am-u-lg-2 am-form-label"><span class="tips">* </span>任务描述</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                            <textarea id="fansRemark" class="am-radius" rows="3"
                                      placeholder="添加任务说明，越详细，越有助于投手正确完成任务。"
                                      v-validate:remark="{required: true}"
                                      name="remark"></textarea>
                                <span class="tips" v-if="$wxFans.remark.required">任务描述不能为空，描述越详细，越有助于投手正确完成任务！</span>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="fansPrice" class="am-u-sm-4 am-u-lg-2 am-form-label"><span class="tips">* </span>投票价格</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                                <input type="hidden" v-model="fansPrice" value="<%= fansPrice %>">
                                <input id="fansPrice" class="am-radius am-input-sm" type="text"
                                       v-model="myFansPrice" name="price"
                                       v-validate:fansprice="{required: true, isfloat:true, minfansprice: true}">
                                <span class="tips" v-if="$wxFans.fansprice.required">价格不能为空!</span>
                                <span class="tips" v-if="$wxFans.fansprice.isfloat">请输入合法的价格!</span>
                                <span class="tips" v-if="$wxFans.fansprice.minfansprice">价格不能低于平台定价<%= fansPrice %>!</span>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label for="fansNum" class="am-u-sm-4 am-u-lg-2 am-form-label"><span class="tips">* </span>数量</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                                <input id="fansNum" class="am-radius am-input-sm" type="text" placeholder="需要增加的粉丝数量，最低20起"
                                       v-validate:num="{required: true, isnum: true, min20: true, maxprice: true}"
                                       name="num" v-model="num" v-on:keyup="total" v-on:change="total">
                                <span class="tips" v-if="$wxFans.num.required">需要添加的投票数量不能为空!</span>
                                <span class="tips" v-if="$wxFans.num.isnum">数量必须为正整数!</span>
                                <span class="tips" v-if="$wxFans.num.min20">需要增加的投票数量，最低20起!</span>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label class="am-u-sm-4 am-u-lg-2 am-form-label">任务总价</label>
                            <div class="am-u-sm-8 am-u-lg-10">
                                <p class="disable taskPrice">￥ {{count}}</p>
                                <span class="tips" v-if="$wxFans.num.maxprice">您的余额不足，请充值!</span>
                                <input type="hidden" v-model="funds" value="<%= money %>">
                            </div>
                        </div>

                        <div class="am-form-group am-form-file no-margin">
                            <label for="doc-ipt-file-2" class="am-u-sm-4 am-u-lg-2 am-form-label">样图</label>
                            <div class="am-u-sm-8 am-u-lg-10 am-g-collapse">
                                <button type="button" class="am-btn am-btn-default am-btn-sm">
                                    <i class="am-icon-cloud-upload"></i> 点击上传样图</button>
                                <span class="tips" id="photoTip" style="display: none">请上传任务验收样图!</span>
                                <input type="file" id="doc-ipt-file-2" @change="viewImg" name="photo">
                            </div>
                        </div>

                        <div class="am-form-group">
                            <label class="am-u-sm-4 am-u-lg-2 am-form-label"></label>
                            <div class="am-u-sm-8 am-u-lg-10 am-g-collapse">
                                <div class="am-u-sm-12 am-u-lg-5">
                                    <img id="preview" class="am-img-responsive">
                                </div>
                            </div>
                        </div>

                        <div class="am-form-group">
                            <div class="am-u-sm-8 am-u-sm-offset-4 am-u-lg-10 am-u-lg-offset-2">
                                <button type="submit" class="am-btn am-btn-primary am-radius"
                                        v-if="$wxFans.valid" @click="check">提交任务</button>
                            </div>
                        </div>
                    </form>
                </validator>

            </div>
        </div>

    </div>
</div>

<link rel="import" href="../../components/foot/foot.html?__inline">

<!--import plugin-->
<!--<script src="/static/js/city.js"></script>-->
<script src="/static/plugins/laydate/laydate.js"></script>


<script>
    require('handleWXvoteAdd');
    //    init();
</script>

</body>
</html>

